import { Vulnerability } from '@/types/semgrep';
import * as S from './styles';
import VulnerabilityItem from '../VulnerabilityItem';
import { useNavigate } from 'react-router-dom';

interface VulnerabilityProps {
  data: Vulnerability[][];
}

const VulnerabilityList = ({ data }: VulnerabilityProps) => {
  const navigate = useNavigate();

  const handleItemClick = (vulnId: string) => {
    navigate(vulnId);
  };

  return (
    <S.VulnerabilityListContainer>
      {data
        .filter((group) => group.length > 0)
        .map((group, idx) => (
          <S.VulnerabilityList key={`severity_${idx}`}>
            {group.map((vuln, itemIdx) => (
              <VulnerabilityItem
                key={`${vuln.id}_${itemIdx}`}
                file={vuln.file}
                line={vuln.line}
                column={vuln.column}
                message={vuln.message}
                severity={vuln.severity}
                handleClick={() => handleItemClick(vuln.id)}
              />
            ))}
          </S.VulnerabilityList>
        ))}
    </S.VulnerabilityListContainer>
  );
};

export default VulnerabilityList;
