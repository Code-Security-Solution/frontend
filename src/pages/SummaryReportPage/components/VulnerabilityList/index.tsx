import { Vulnerability } from '@/types/semgrep';
import * as S from './styles';
import VulnerabilityItem from '../VulnerabilityItem';

interface VulnerabilityProps {
  data: Vulnerability[][];
}

const VulnerabilityList = ({ data }: VulnerabilityProps) => {
  return (
    <S.VulnerabilityListContainer>
      {data.map((group, idx) => {
        return (
          <S.VulnerabilityList key={`severity_${idx}`}>
            {group.map((vuln) => (
              <VulnerabilityItem
                key={vuln.id}
                file={vuln.file}
                line={vuln.line}
                column={vuln.column}
                message={vuln.message}
                severity={vuln.severity}
              />
            ))}
          </S.VulnerabilityList>
        );
      })}
    </S.VulnerabilityListContainer>
  );
};

export default VulnerabilityList;
