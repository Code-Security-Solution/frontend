import { Severity } from '@/types/semgrep';
import { FaChevronRight } from 'react-icons/fa6';

import * as S from './styles';
import SeverityBadge from '../SeverityBadge';
import theme from '@/styles/theme';

interface VulnerabilityItemProps {
  file: string;
  line: number;
  column: number;
  message: string;
  severity: Severity;
}

const VulnerabilityItem = ({ file, line, column, message, severity }: VulnerabilityItemProps) => {
  return (
    <S.VulnerabilityItemContainer>
      <S.SeverityColorBar $severity={severity} />
      <S.VulnerabilityItemContent>
        <S.VulnerabilityInfoContainer>
          <SeverityBadge severity={severity} />
          <S.VulnerabilityOrigin>{`${file}:${line}, ${column}`}</S.VulnerabilityOrigin>
        </S.VulnerabilityInfoContainer>
        <S.VulnerabilityMessage>{message}</S.VulnerabilityMessage>
      </S.VulnerabilityItemContent>
      <S.ArrowIconWrapper>
        <FaChevronRight size={24} color={theme.colors.gray500} />
      </S.ArrowIconWrapper>
    </S.VulnerabilityItemContainer>
  );
};

export default VulnerabilityItem;
